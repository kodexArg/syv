---
import { DOCUMENTS_SCHEMA } from '../../content/constants';

interface Props {
  currentPath?: string;
}

interface BreadcrumbItem {
  name: string;
  path: string;
  icon: string;
}

const { currentPath = "/" } = Astro.props;

const generateBreadcrumbs = (path: string): BreadcrumbItem[] => {
  if (path === "/" || path === "") {
    return [{ name: "Home", path: "/", icon: "fas fa-home" }];
  }
  
  const segments = path.split("/").filter(Boolean);
  const breadcrumbs: BreadcrumbItem[] = [{ name: "Home", path: "/", icon: "fas fa-home" }];
  
  if (segments[0] === "docs" && segments.length > 1) {
    const collectionKey = segments[1];
    
    const collectionConfig = DOCUMENTS_SCHEMA[collectionKey as keyof typeof DOCUMENTS_SCHEMA];
    if (collectionConfig) {
      breadcrumbs.push({
        name: collectionConfig.name,
        path: `/docs/${collectionKey}/`,
        icon: collectionConfig.breadcrumbIcon
      });
    }
    
    if (segments.length > 2) {
      const lastSegment = segments[segments.length - 1];
      breadcrumbs.push({
        name: lastSegment.charAt(0).toUpperCase() + lastSegment.slice(1).replace(/-/g, ' '),
        path: currentPath,
        icon: 'fas fa-file'
      });
    }
  }
  
  return breadcrumbs;
};

const breadcrumbs = generateBreadcrumbs(currentPath);
---

<nav class="flex items-center gap-2" aria-label="Breadcrumb">
  {breadcrumbs.map((item, index) => (
    <div class="flex items-center gap-2">
      {index > 0 && (
        <i class="fas fa-chevron-right text-military-400 text-xs" aria-hidden="true"></i>
      )}
      <a 
        href={item.path} 
        class="text-military-600 flex items-center gap-2 no-underline text-sm hover:text-military-800 transition-colors"
        aria-current={index === breadcrumbs.length - 1 ? "page" : undefined}
      >
        <i class={item.icon} aria-hidden="true"></i>
        {item.name}
      </a>
    </div>
  ))}
</nav>