---
import { obtenerNombreCompleto, obtenerIconoBreadcrumb } from '../../content/config';

interface Props {
  currentPath?: string;
}

interface MigaDePan {
  name: string;
  path: string;
  icon: string;
}

const { currentPath = "/" } = Astro.props;

const generarMigasDePan = (ruta: string): MigaDePan[] => {
  if (ruta === "/" || ruta === "") {
    return [{ name: "Inicio", path: "/", icon: "fas fa-home" }];
  }
  
  const segmentos = ruta.split("/").filter(Boolean);
  const migasDePan: MigaDePan[] = [{ name: "Inicio", path: "/", icon: "fas fa-home" }];
  
  if (segmentos[0] === "docs" && segmentos.length > 1) {
    const claveColeccion = segmentos[1];
    
    migasDePan.push({
      name: obtenerNombreCompleto(claveColeccion),
      path: `/docs/${claveColeccion}/`,
      icon: obtenerIconoBreadcrumb(claveColeccion)
    });
    
    if (segmentos.length > 2) {
      const ultimoSegmento = segmentos[segmentos.length - 1];
      migasDePan.push({
        name: ultimoSegmento.charAt(0).toUpperCase() + ultimoSegmento.slice(1).replace(/-/g, ' '),
        path: currentPath,
        icon: 'fas fa-file'
      });
    }
  }
  
  return migasDePan;
};

const migasDePan = generarMigasDePan(currentPath);
---

<nav class="flex items-center gap-2" aria-label="Breadcrumb">
  {migasDePan.map((miga, indice) => (
    <div class="flex items-center gap-2">
      {indice > 0 && (
        <i class="fas fa-chevron-right text-military-400 text-xs" aria-hidden="true"></i>
      )}
      <a 
        href={miga.path} 
        class="text-military-600 flex items-center gap-2 no-underline text-sm hover:text-military-800 transition-colors"
        aria-current={indice === migasDePan.length - 1 ? "page" : undefined}
      >
        <i class={miga.icon} aria-hidden="true"></i>
        {miga.name}
      </a>
    </div>
  ))}
</nav>