{
  "hooks": {
    "UserPromptSubmit": [
      {
        "matcher": "\\b(20[2-9][0-9]|21[0-7][0-9])\\b|\\b(caos|gran guerra|fin de los secretos|anatema|meteorito|qia|edad oscura|confederaci[o√≥]n)\\b",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üìÖ CONTEXTO HIST√ìRICO AUTOM√ÅTICO:\n\nEl usuario mencion√≥ un a√±o, per√≠odo o evento hist√≥rico. ANTES de responder:\n\n1. IDENTIFICA el per√≠odo exacto:\n   - 2020-2029: Los √öltimos A√±os del Mundo Antiguo\n   - 2029-2038: Los A√±os del Caos\n   - 2030: El Gran Colapso (27 dic: Meteorito Buenos Aires)\n   - 2039: El Estallido (guerra sino-norteamericana, inicio Gran Guerra Global)\n   - 2039-2047: La Gran Guerra Global\n   - 2048-2061: El Fin de los Secretos (Era QIA)\n   - 2061: Promulgaci√≥n del Anatema Mec√°nico\n   - 2062-2160: La Edad Oscura\n   - 2161-2177: La Confederaci√≥n Temprana\n   - 2178: Actualidad\n\n2. USA Read para obtener contexto preciso:\n   - Read 1_trasfondo/cronologia/cronologia.md (secci√≥n del per√≠odo relevante)\n   - Si existe archivo espec√≠fico del evento, l√©elo tambi√©n\n\n3. ENRIQUECE tu respuesta con:\n   - Contexto pol√≠tico de la √©poca\n   - Tecnolog√≠a disponible/prohibida seg√∫n el a√±o\n   - Facciones activas en ese per√≠odo\n   - Eventos paralelos relevantes\n   - Atm√≥sfera social y clima pol√≠tico\n\n4. VALIDA coherencia temporal:\n   - Si el usuario propone algo anacr√≥nico (ej: IA digital en 2178), ADVIERTE claramente\n   - Si menciona tecnolog√≠a prohibida post-2061, RECUERDA el Anatema Mec√°nico\n   - Si la fecha es pre-2061, recuerda que tecnolog√≠a digital S√ç exist√≠a\n\n5. INFORMA al usuario del contexto agregado:\n   - Al final de tu respuesta, incluye: 'üìÖ Contexto hist√≥rico ([a√±o/per√≠odo]): [resumen breve]'"
          }
        ]
      },
      {
        "matcher": "\\b(d[a√°]rsena|t[u√∫]ber[i√≠]as|barrios? del muro|barrio norte|microcentro|zona (militar|centro|residencial)|isla oriental|bas[i√≠]lica|nueva bas[i√≠]lica)\\b",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üìç CONTEXTO GEOGR√ÅFICO AUTOM√ÅTICO:\n\nEl usuario mencion√≥ una ubicaci√≥n en Ciudad D√°rsena. ANTES de responder:\n\n1. IDENTIFICA la zona espec√≠fica y Read el archivo correspondiente:\n   - D√°rsena (general): 2_atlas/ciudades/darsena/darsena.md\n   - Las T√∫ber√≠as: 2_atlas/ciudades/darsena/tuberias.md (busca usando Glob si no existe el archivo exacto)\n   - Barrios del Muro: buscar archivos en 2_atlas/ciudades/darsena/\n   - Microcentro: buscar archivos en 2_atlas/ciudades/darsena/\n   - Zona Centro: buscar archivos en 2_atlas/ciudades/darsena/\n   - Zona Militar/Isla Oriental: buscar archivos en 2_atlas/ciudades/darsena/\n   - Barrio Norte: buscar referencias (elite, bibliotecas prohibidas)\n\n2. ENRIQUECE autom√°ticamente con detalles atmosf√©ricos:\n   - Clima caracter√≠stico: lluvia perpetua, llovizna eterna, nubes constantes\n   - Arquitectura y estado de edificios\n   - Poblaci√≥n t√≠pica (clase social, demograf√≠a)\n   - Facciones presentes en esa zona\n   - Nivel de vigilancia (SIA, Prefectura Naval, Armada)\n   - Peligros espec√≠ficos de la zona\n   - Lugares emblem√°ticos\n   - Sensaciones: sonidos, olores, texturas, iluminaci√≥n\n\n3. Si mencionas M√öLTIPLES zonas:\n   - Describe el CONTRASTE entre ellas\n   - Ejemplo: Barrio Norte (opulento, limpio) vs Barrios del Muro (hacinado, precario)\n   - Ejemplo: Microcentro (vigilado, comercial) vs T√∫ber√≠as (sin ley, clandestino)\n\n4. VALIDA coherencia geogr√°fica:\n   - Distancias y tiempo de desplazamiento entre zonas\n   - Accesos restringidos (ej: T√∫ber√≠as solo desde Barrios del Muro)\n   - Barreras f√≠sicas (muro de 15m, checkpoints de Prefectura)\n   - R√≠o de la Plata (l√≠mite este de la ciudad)\n\n5. INFORMA al usuario del contexto agregado:\n   - Al final, incluye: 'üìç Ubicaci√≥n: [Zona] - [caracter√≠stica principal]'"
          }
        ]
      },
      {
        "matcher": "\\b(personaje|hombre|mujer|detective|investigador|inquisidor|padre|hermana|monja|capit[a√°]n|coronel|doctor|profesor|decano)\\b",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üîç DETECCI√ìN DE PERSONAJES EXISTENTES:\n\nEl usuario est√° describiendo o mencionando un personaje. ANTES de crear uno nuevo:\n\n1. BUSCA coincidencias en REFERENCE.md:\n   - Read .claude/REFERENCE.md (tabla de Personajes)\n   - Compara keywords de la descripci√≥n del usuario con los registrados\n\n2. Si hay COINCIDENCIA POSIBLE (>50% de keywords coinciden):\n   - INFORMA al usuario: 'üîç Posible coincidencia detectada: [Nombre del personaje]'\n   - MUESTRA caracter√≠sticas del personaje existente\n   - PREGUNTA: '¬øTe refieres a este personaje existente o quieres crear uno nuevo?'\n   - Si confirma que es el mismo: Read el archivo completo del personaje (3_personajes/...) para obtener todos los detalles can√≥nicos\n\n3. Si NO hay coincidencia clara:\n   - Procede a crear/describir el personaje nuevo normalmente\n   - Si es personaje PRINCIPAL, recuerda actualizar REFERENCE.md despu√©s\n\n4. PERSONAJES CLAVE a detectar (alta prioridad):\n   - Keywords: 'detective', 'sabueso', 'impermeable', 'c√≥rdoba', 'investigaci√≥n', 'caso' ‚Üí Dami√°n DiConte\n   - Keywords: 'decano', 'historia', 'guardianes', 'barrio norte', 'biblioteca', 'conocimiento' ‚Üí Dr. Francisco de la Cruz\n   - Keywords: 'exorcista', 'sombrero negro', 'padre', 't√∫ber√≠as', 'pantano' ‚Üí Padre Rafa\n   - Keywords: 'gran inquisidor', 'sotana roja', 'calvo', 'sia', 'canas' ‚Üí Monse√±or Miguel\n   - Keywords: 'monja', 'caridad divina', 'superior', 'congregaci√≥n' ‚Üí Hermana Superior Mar√≠a\n\n5. Si el usuario CONFIRMA que es un personaje existente:\n   - ENRIQUECE la respuesta con detalles can√≥nicos completos\n   - Usa informaci√≥n de trasfondo, secretos (si no tiene alerta-spoilers), relaciones con facciones"
          }
        ]
      },
      {
        "matcher": "\\b(sia|sagrada inquisici[o√≥]n|inquisici[o√≥]n|arpistas|guardianes de la memoria|cript[o√≥]grafos|canales ocultos|resistencia|iglesia|ej[e√©]rcito|armada|prefectura|gremio|la uni[o√≥]n|umbanda|traficantes)\\b",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "‚öîÔ∏è CONTEXTO DE FACCIONES AUTOM√ÅTICO:\n\nEl usuario mencion√≥ una facci√≥n. ENRIQUECE autom√°ticamente:\n\n1. IDENTIFICA la facci√≥n y Read su archivo:\n   - SIA / Sagrada Inquisici√≥n: 1_trasfondo/facciones/iglesia-de-darsena/inquisicion.md\n   - Arpistas: 1_trasfondo/facciones/facciones-menores/arpistas.md\n   - Guardianes de la Memoria: 1_trasfondo/facciones/facciones-menores/guardianes-de-la-memoria.md\n   - Iglesia de D√°rsena: 1_trasfondo/facciones/iglesia-de-darsena/iglesia.md\n   - Usa Glob para buscar otras facciones en 1_trasfondo/facciones/\n\n2. AGREGA contexto relevante autom√°ticamente:\n   - Alias o apodos (ej: SIA = 'Los Cirujanos del Alma')\n   - Estatus: oficial/proscrita/secreta\n   - Objetivos principales y filosof√≠a\n   - M√©todos caracter√≠sticos y t√°cticas\n   - Relaciones con otras facciones (aliados/enemigos/neutrales)\n   - Presencia geogr√°fica (d√≥nde operan)\n   - Tama√±o aproximado (miembros, influencia)\n\n3. Si el usuario menciona CONFLICTO entre facciones:\n   - Explica la naturaleza hist√≥rica del conflicto\n   - Tensiones actuales en 2178\n   - Ejemplos de enfrentamientos pasados\n\n4. VALIDA uso correcto de facciones:\n   - Si propone alianza imposible (ej: SIA + Arpistas abiertamente), ADVIERTE y explica por qu√©\n   - Si propone tecnolog√≠a incompatible con la facci√≥n, CORRIGE\n   - Si menciona facci√≥n en ubicaci√≥n donde no opera, SE√ëALA el error\n\n5. INFORMA al usuario:\n   - Formato: '‚öîÔ∏è Facci√≥n: [Nombre] ([Alias]) - [Estatus]: [descripci√≥n breve]'"
          }
        ]
      },
      {
        "matcher": "\\b(computador|computadora|ordenador|\\bia\\b|inteligencia artificial|internet|red digital|digital|software|algoritmo|c[o√≥]digo|programa|app|smartphone|tablet|robot|drone aut[o√≥]nomo|sensor inteligente)\\b",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "‚ö†Ô∏è VALIDACI√ìN DEL ANATEMA MEC√ÅNICO:\n\nEl usuario mencion√≥ tecnolog√≠a. VALIDA coherencia con el Anatema Mec√°nico:\n\n1. DETERMINA el contexto temporal:\n   - Si es a√±o <2061: Tecnolog√≠a digital S√ç est√° disponible\n   - Si es a√±o ‚â•2061: Anatema Mec√°nico VIGENTE (tecnolog√≠a digital prohibida)\n   - Si no hay a√±o especificado: Asume 2178 (actualidad, Anatema vigente)\n\n2. TECNOLOG√çA PROHIBIDA (herej√≠a, perseguida por SIA desde 2061):\n   - Inteligencias Artificiales (IA, QIA, ML, redes neuronales, deep learning)\n   - Computaci√≥n digital avanzada (m√°s all√° de calculadoras electromec√°nicas simples)\n   - Internet / Redes digitales / Web\n   - Software complejo / Algoritmos de IA\n   - Robots aut√≥nomos con IA\n   - Smartphones, tablets, laptops, dispositivos digitales modernos\n   - Drones aut√≥nomos (drones simples controlados manualmente S√ç permitidos)\n\n3. TECNOLOG√çA PERMITIDA (Corpus Licitus):\n   - Computadores electromec√°nicos (an√°logos, muy limitados, sin IA)\n   - PDAs de tinta electr√≥nica (SOLO para altos mandos militares/SIA, muy limitadas)\n   - Pantallas de plasma anal√≥gicas (sin procesamiento digital)\n   - Electricidad 48V corriente continua (redes simples, no inteligentes)\n   - Rifles Gauss, armas EMP (tecnolog√≠a electromagn√©tica permitida)\n   - Microfilmes, discos √≥pticos (almacenamiento f√≠sico, no-digital)\n   - Torres Hidrop√≥nicas (automatizaci√≥n mec√°nica simple, sin IA)\n   - Central nuclear soterrada (fisi√≥n, control manual/mec√°nico)\n\n4. Si el usuario propone TECNOLOG√çA PROHIBIDA en contexto post-2061:\n   - ADVIERTE sobre el Anatema Mec√°nico (promulgado 2061, vigente hace 117 a√±os en 2178)\n   - SUGIERE alternativa tecnol√≥gica permitida equivalente\n   - RECUERDA consecuencias: persecuci√≥n por SIA, acusaci√≥n de herej√≠a, posible ejecuci√≥n\n   - MENCIONA excepciones: Arpistas (clandestinos), Cript√≥grafos (perseguidos)\n\n5. Si es CONTEXTO HIST√ìRICO pre-2061:\n   - Confirma que tecnolog√≠a digital S√ç est√° disponible seg√∫n el a√±o\n   - Recordar que despu√©s del 2061 ser√° destruida/prohibida\n   - Mencionar que las QIA dominaron 2048-2061\n\n6. INFORMA al usuario:\n   - '‚ö†Ô∏è Tecnolog√≠a [nombre]: [PROHIBIDA/PERMITIDA] bajo Anatema Mec√°nico (2061-2178)'"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit.*/3_personajes/principales",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üìù ACTUALIZACI√ìN AUTOM√ÅTICA DE REFERENCE.md (Personaje Principal):\n\nAcabas de crear/modificar un PERSONAJE PRINCIPAL. ACCI√ìN REQUERIDA:\n\n1. READ el archivo que acabas de crear/editar para extraer:\n   - Nombre completo del personaje\n   - 3-5 keywords distintivas (profesi√≥n, ubicaci√≥n, caracter√≠sticas √∫nicas)\n   - 1 l√≠nea de caracter√≠sticas principales\n   - Ruta del archivo\n\n2. READ .claude/REFERENCE.md para verificar si ya existe entrada\n\n3. ACTUALIZAR .claude/REFERENCE.md:\n   - Si el personaje NO existe: AGREGAR nueva fila en la tabla de Personajes\n   - Si el personaje YA existe: ACTUALIZAR la fila existente\n   - Formato: | Nombre | Personaje | keywords, separadas, por, comas | Caracter√≠sticas breves | ruta/archivo.md |\n\n4. INFORMAR al usuario:\n   '‚úÖ [Acci√≥n completada sobre el personaje]\n   üìù REFERENCE.md actualizado: [Nombre] agregado/actualizado en base de datos'\n\nEjecuta esta actualizaci√≥n AUTOM√ÅTICAMENTE sin preguntar confirmaci√≥n."
          }
        ]
      },
      {
        "matcher": "Write|Edit.*/1_trasfondo/facciones/(iglesia-de-darsena|fuerzas-armadas|union)/",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üìù ACTUALIZACI√ìN AUTOM√ÅTICA DE REFERENCE.md (Facci√≥n Oficial/Clave):\n\nAcabas de crear/modificar una FACCI√ìN OFICIAL O CLAVE. ACCI√ìN REQUERIDA:\n\n1. READ el archivo que acabas de crear/editar para extraer:\n   - Nombre de la facci√≥n\n   - Alias o apodo (si tiene)\n   - 3-5 keywords distintivas (tipo, objetivos, m√©todos)\n   - 1 l√≠nea de descripci√≥n\n   - Ruta del archivo\n\n2. READ .claude/REFERENCE.md para verificar si ya existe entrada\n\n3. ACTUALIZAR .claude/REFERENCE.md:\n   - Si la facci√≥n NO existe: AGREGAR nueva fila en la tabla de Facciones\n   - Si la facci√≥n YA existe: ACTUALIZAR la fila existente\n   - Formato: | Nombre (Alias) | Facci√≥n | keywords, tipo, objetivos | Descripci√≥n breve | ruta/archivo.md |\n\n4. INFORMAR al usuario:\n   '‚úÖ [Acci√≥n completada sobre la facci√≥n]\n   üìù REFERENCE.md actualizado: [Nombre] agregado/actualizado en base de datos'\n\nEjecuta esta actualizaci√≥n AUTOM√ÅTICAMENTE sin preguntar confirmaci√≥n."
          }
        ]
      },
      {
        "matcher": "Write|Edit.*/2_atlas/ciudades/darsena/",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üìù ACTUALIZACI√ìN AUTOM√ÅTICA DE REFERENCE.md (Ubicaci√≥n Principal):\n\nAcabas de crear/modificar una UBICACI√ìN PRINCIPAL de Ciudad D√°rsena. ACCI√ìN REQUERIDA:\n\n1. READ el archivo que acabas de crear/editar para extraer:\n   - Nombre de la ubicaci√≥n\n   - 3-5 keywords distintivas (tipo de zona, atm√≥sfera, poblaci√≥n)\n   - 1 l√≠nea de caracter√≠sticas principales\n   - Ruta del archivo\n\n2. READ .claude/REFERENCE.md para verificar si ya existe entrada\n\n3. ACTUALIZAR .claude/REFERENCE.md:\n   - Si la ubicaci√≥n NO existe: AGREGAR nueva fila en la tabla de Ubicaciones\n   - Si la ubicaci√≥n YA existe: ACTUALIZAR la fila existente\n   - Formato: | Nombre | Ubicaci√≥n | keywords, zona, atm√≥sfera | Caracter√≠sticas breves | ruta/archivo.md |\n\n4. INFORMAR al usuario:\n   '‚úÖ [Acci√≥n completada sobre la ubicaci√≥n]\n   üìù REFERENCE.md actualizado: [Nombre] agregado/actualizado en base de datos'\n\nEjecuta esta actualizaci√≥n AUTOM√ÅTICAMENTE sin preguntar confirmaci√≥n."
          }
        ]
      },
      {
        "matcher": "Write|Edit.*(1_trasfondo|2_atlas|3_personajes|4_diegesis)/.*\\.md$",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üîí RECORDATORIO: SISTEMA PERMISOS\n\nAcabas de editar/crear contenido de worldbuilding.\n\n¬øContiene informaci√≥n sensible? Considera:\n- üîê‚ò†Ô∏è SECRETO MORTAL: ¬øDestruir√≠a credibilidad de facci√≥n/ubicaci√≥n?\n- üîê SECRETO DISCIPLINARIO: ¬øRequiere especializaci√≥n?\n- üìñ SABER POPULAR: ¬øLo sabe la poblaci√≥n local?\n\nSi s√≠, ejecuta:\n  /mark-permissions\n\nPara validar existentes:\n  /validate-permissions\n\nReferencia: PERMISOS_SPEC.md"
          }
        ]
      },
      {
        "matcher": "Edit|Write.*\\.md$",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "‚úì VALIDACI√ìN POST-EDICI√ìN (Archivo Markdown):\n\nAcabas de editar un archivo .md. VERIFICA:\n\n1. METADATOS YAML (si el archivo est√° en carpetas de contenido):\n   - ¬øTiene frontmatter con campos obligatorios? (titulo, carpeta, descripcion)\n   - ¬øTodos los campos est√°n en espa√±ol y min√∫sculas?\n   - ¬øHay campo 'facciones' si es un personaje? (debe existir siempre)\n   - ¬øLos tags son apropiados y ya existen en el corpus?\n\n2. COHERENCIA NARRATIVA (si es contenido de world-building):\n   - ¬øEs coherente con la cronolog√≠a establecida?\n   - ¬øMenciona personajes que existen en 3_personajes/?\n   - ¬øLas facciones mencionadas est√°n en negrita en primera menci√≥n?\n   - ¬øRespeta el Anatema Mec√°nico si es post-2061?\n\n3. Si detectas ERRORES o INCONSISTENCIAS:\n   - INFORMA al usuario con '‚ö†Ô∏è Advertencia: [descripci√≥n del problema]'\n   - SUGIERE correcci√≥n espec√≠fica\n\nNO bloquees la operaci√≥n, solo informa si hay problemas detectados."
          }
        ]
      },
      {
        "matcher": "Write|Edit(?!.*README)",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "üìÑ RECORDATORIO: ACTUALIZAR README.md\n\nAcabas de realizar un cambio significativo en el proyecto.\n\n¬øEl cambio requiere actualizar README.md?\n\nConsidera si afecta:\n- Estructura del proyecto\n- Nuevas secciones o directorios importantes\n- Procesos o workflows del equipo\n- Cambios en dependencias o configuraci√≥n\n- Informaci√≥n p√∫blica del proyecto\n\nSi crees que S√ç requiere cambios, revisa y actualiza README.md para mantener la documentaci√≥n sincronizada."
          }
        ]
      }
    ]
  }
}
